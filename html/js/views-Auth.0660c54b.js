(window.webpackJsonp=window.webpackJsonp||[]).push([["views-Auth","components-ItdTypeAhead-VueBootstrapTypeahead","mixins-Auth"],{"15cc":function(t,e,o){"use strict";function n(t,e,o,n,r,i,u){var a,c;try{c=(a=t[i](u)).value}catch(s){return void o(s)}a.done?e(c):Promise.resolve(c).then(n,r)}function r(t){return function(){var e=this,o=arguments;return new Promise((function(r,i){function u(t){n(c,r,i,u,a,"next",t)}function a(t){n(c,r,i,u,a,"throw",t)}var c=t.apply(e,o);u(void 0)}))}}function i(t,e){var o,n=Object.keys(t);return Object.getOwnPropertySymbols&&(o=Object.getOwnPropertySymbols(t),e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)),n}function u(t){var e,o;for(e=1;e<arguments.length;e++)o=null!=arguments[e]?arguments[e]:{},e%2?i(Object(o),!0).forEach((function(e){a(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}));return t}function a(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var c,s,l;o.r(e),c=o("ac0d"),s=o.n(c),l=o("f42e"),e.default={name:"auth",data:function(){return{form:null,formAuth:[],show:!1,myOption:{option:""},myAuth:{},options:[],optionsForm:{},error:"",authShow:!0,validOption:!1}},computed:u(u({},Object(l.e)("auth",["auth","userData","modelAuth","modelOption"])),{},{option:{get:function(){return this.modelOption||this.myOption.option},set:function(t){this.myOption.option=t}},canSend:function(){var t=this.myAuth,e=Object.keys(t).length,o=Object.keys(t).filter((function(e){return!!t[e]})).length;return o===e},localModel:function(){return this.modelAuth||"User"}}),watch:{option:{handler:function(t){this.validOption=!!t},immediate:!0}},beforeMount:function(){this.mergeAuth({authEndpoint:!0})},methods:u(u(u(u({},Object(l.b)("auth",["checkLogin","logout","showAuth"])),Object(l.d)("auth",["mergeAuth"])),Object(l.b)("Alert",["success"])),{},{onShow:function(t){this.auth?(t.preventDefault(),console.debug("signout user"),this.logout()):(console.debug("ejecutando modal auth"),this.show=!0)},getOptions:function(){var t=this;return r(s.a.mark((function e(){var o,n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.post("/APP/AAA/authForm.json",{model:t.localModel});case 2:return o=e.sent,n=o.body,t.options=n,r=[{type:"select",tag:"b-radio-group",component:"ItdSelect",name:"option",label:"Seleccione la forma de autenticar",value:null,options:n}],console.debug("getOptions"),console.debug(r),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})))()},getForm:function(){var t=this;return r(s.a.mark((function e(){var o,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.debug("getForm"),e.next=3,t.$http.post("/APP/AAA/authForm.json",{model:t.localModel,option:t.option});case 3:return o=e.sent,n=o.body,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))()},submitAuth:function(){var t=this;return r(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.$refs.formAuth.localForm[1].error="",t.$refs.formAuth.localForm[1].state=!0,e.next=4,t.$nextTick();case 4:t.$refs.formAuth.submit();case 5:case"end":return e.stop()}}),e)})))()},sendAuth:function(){var t=this;return r(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.checkLogin(t.myAuth);case 3:e.next=11;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("ERROR DE AUTENTICACION"),console.error(e.t0),t.$refs.formAuth.localForm[1].error="Error de autenticación",t.$refs.formAuth.localForm[1].state=!1;case 11:case"end":return e.stop()}}),e,null,[[0,5]])})))()},recovery:function(){var t,e=this,o=this.myAuth.email;if(this.$refs.formAuth.localForm[0].error="",this.$refs.formAuth.localForm[0].state=!0,o)return t=this.modelAuth,this.$http.get("/APP/AAA/recovery.json",{params:{email:o,model:t}}).then((function(t){var o=t.body;console.debug("resultado recovery",o),e.success("Se le ha enviado un correo con las instrucciones de recuperación")})).catch((function(t){console.error("recovery",t)}));this.$refs.formAuth.localForm[0].error="Debe ingresar su email",this.$refs.formAuth.localForm[0].state=!1,this.$refs.formAuth.validateForm()}})}},"1ea6":function(t,e,o){"use strict";var n,r,i,u,a;o.r(e),n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("b-modal",{attrs:{id:"authenticate",title:"Autenticación","ok-title":"Ingresar","cancel-title":"Cancelar","ok-disabled":!t.canSend},on:{show:t.onShow,ok:function(e){return e.preventDefault(),t.sendAuth(e)}},model:{value:t.authShow,callback:function(e){t.authShow=e},expression:"authShow"}},[t.show?[t.modelOption?t._e():o("api-request",{attrs:{resource:t.getOptions},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}},[t.form?o("itd-form",{key:"1",attrs:{config:t.optionsForm,form:t.form,cols:"1"},model:{value:t.myOption,callback:function(e){t.myOption=e},expression:"myOption"}}):t._e()],1),o("api-request",{attrs:{trigger:t.validOption,resource:t.getForm},on:{"update:trigger":function(e){t.validOption=e}},model:{value:t.formAuth,callback:function(e){t.formAuth=e},expression:"formAuth"}},[t.formAuth&&t.option?o("itd-form",{key:"2",ref:"formAuth",attrs:{config:t.optionsForm,form:t.formAuth,cols:"1"},on:{submit:function(e){return e.preventDefault(),t.sendAuth(e)}},model:{value:t.myAuth,callback:function(e){t.myAuth=e},expression:"myAuth"}}):t._e()],1)]:t._e()],2)},r=[],i={$BVP:"ModalPlugin",mixins:[o("15cc").default]},u=o("2a6f"),a=Object(u.a)(i,n,r,!1,null,null,null),e.default=a.exports},"2a6f":function(t,e,o){"use strict";function n(t,e,o,n,r,i,u,a){var c,s,l,f="function"==typeof t?t.options:t;return e&&(f.render=e,f.staticRenderFns=o,f._compiled=!0),n&&(f.functional=!0),i&&(f._scopeId="data-v-"+i),u?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(u)},f._ssrRegister=c):r&&(c=a?function(){r.call(this,(f.functional?this.parent:this).$root.$options.shadowRoot)}:r),c&&(f.functional?(f._injectStyles=c,s=f.render,f.render=function(t,e){return c.call(e),s(t,e)}):(l=f.beforeCreate,f.beforeCreate=l?[].concat(l,c):[c])),{exports:t,options:f}}o.d(e,"a",(function(){return n}))}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([["views-Khipu","components-ItdTypeAhead-VueBootstrapTypeahead"],{11891:function(t,e,n){"use strict";function r(t,e,n,r,o,a,i){var c,s;try{s=(c=t[a](i)).value}catch(u){return void n(u)}c.done?e(s):Promise.resolve(s).then(r,o)}var o,a,i,c,s,u,p;n.r(e),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-switch",{attrs:{value:t.type},scopedSlots:t._u([{key:"init",fn:function(){return[n("h2",[t._v("Generando la transacción en Khipu")])]},proxy:!0},{key:"cancel",fn:function(){return[n("h2",[t._v("Pago Cancelado")])]},proxy:!0},{key:"return",fn:function(){return[n("div",[n("h2",[t._v("Esperando respuesta")]),n("p",[t._v(" Estamos esperando que Khipu confirme la transacción, de todas formas le llegará un correo informando si la operación fue exitosa y podrá recargar esta página en cualquier momento para verificar ")]),n("api-request",{attrs:{resource:t.getTRX},model:{value:t.trx,callback:function(e){t.trx=e},expression:"trx"}},[n("h3",[t._v("Pago realizado exitosamente")]),n("b-btn",{attrs:{variant:"primary",href:t.trx&&t.trx.receipt_url}},[t._v("Descargar Recibo")])],1)],1)]},proxy:!0}])})},a=[],i=n("ac0d"),c=n.n(i),s={$BVP:"ButtonPlugin",data:function(){return{trx:null,sse:null}},computed:{type:function(){var t=this.$route.query.type;return"init"===t&&this.initTrx(),t},transaction_id:function(){return this.$route.query.transaction_id||""}},watch:{type:{handler:function(t){"cancel"===t&&this.$http.get(this.$route.path+".clear").then((function(t){var e=t.body;console.debug("resultado del borrado",e)}))},immediate:!0}},methods:{initTrx:function(){return this.$http.get(this.$route.path+".json").then((function(t){var e=t.body;location.href=e.payment_url}))},getTRX:function(){var t,e=this;return(t=c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("return"!==e.type){t.next=5;break}return n=e.$sse.create({url:e.$route.path+".sse?transaction_id="+e.transaction_id}),t.next=4,n.connect();case 4:return t.abrupt("return",new Promise((function(t,r){n.on("error",(function(t){console.error("SSE",t),r(t),n.disconnect()})),n.once("".concat(e.transaction_id),(function(r){console.debug("SSE",e.transaction_id,r),t(r),n.disconnect(),e.$http.get(e.$route.path+".clear")}))})));case 5:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(o,a){function i(t){r(s,o,a,i,c,"next",t)}function c(t){r(s,o,a,i,c,"throw",t)}var s=t.apply(e,n);i(void 0)}))})()}}},u=n("2a6f"),p=Object(u.a)(s,o,a,!1,null,null,null),e.default=p.exports},"2a6f":function(t,e,n){"use strict";function r(t,e,n,r,o,a,i,c){var s,u,p,d="function"==typeof t?t.options:t;return e&&(d.render=e,d.staticRenderFns=n,d._compiled=!0),r&&(d.functional=!0),a&&(d._scopeId="data-v-"+a),i?(s=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},d._ssrRegister=s):o&&(s=c?function(){o.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:o),s&&(d.functional?(d._injectStyles=s,u=d.render,d.render=function(t,e){return s.call(e),u(t,e)}):(p=d.beforeCreate,d.beforeCreate=p?[].concat(p,s):[s])),{exports:t,options:d}}n.d(e,"a",(function(){return r}))}}]);